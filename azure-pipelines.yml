# Copyright (c) Bosch Software Innovations GmbH 2019.
#
# All rights reserved. This program and the accompanying materials
# are made available under the terms of the Eclipse Public License v2.0
# which accompanies this distribution, and is available at
# http://www.eclipse.org/legal/epl-v20.html
#
# SPDX-License-Identifier: EPL-2.0
trigger:
  branches:
    include:
      - '*'

pool:
  vmImage: 'ubuntu-latest'

container: 'maven:3.6-jdk-8-slim'

steps:
- task: Maven@3
  displayName: 'mvn install'
  inputs:
    mavenPomFile: 'pom.xml'
    goals: 'install'
    publishJUnitResults: true
    testResultsFiles: '**/surefire-reports/TEST-*.xml'
    javaHomeOption: 'JDKVersion'
    mavenVersionOption: 'Default'
    mavenAuthenticateFeed: false
    sonarQubeRunAnalysis: false
    checkStyleRunAnalysis: true
    pmdRunAnalysis: true
    findBugsRunAnalysis: true

- task: Bash@3
  displayName: 'test example project with maven'
  inputs:
    targetType: 'inline'
    script: '.ci-scripts/test-ExampleTestProject-with-maven.sh'

- task: Bash@3
  displayName: 'test example project with cli'
  inputs:
    targetType: 'inline'
    script: '.ci-scripts/test-ExampleTestProject-with-CLI.sh'

- task: Bash@3
  displayName: 'test example project with gradle'
  inputs:
    targetType: 'inline'
    script: '.ci-scripts/test-ExampleTestProject-with-gradle.sh'

- task: Bash@3
  displayName: 'site-tests in antenna-documentation'
  inputs:
    targetType: 'inline'
    script: '.ci-scripts/test-antenna-documentation-site-tests.sh'
