<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2020-06-15 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20200615" />
    <meta http-equiv="Content-Language" content="en" />
    <title>antenna-documentation &#x2013; Workflow configuration</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarDisabled">
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>Antenna Documentation</h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2020-06-15<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.0.0-SNAPSHOT</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
          <li class="nav-header">Overview</li>
    <li><a href="index.html" title="About"><span class="none"></span>About</a>  </li>
    <li><a href="getting-started.html" title="Getting started"><span class="none"></span>Getting started</a>  </li>
    <li><a href="how-to-use.html" title="How to use Antenna"><span class="icon-chevron-down"></span>How to use Antenna</a>
      <ul class="nav nav-list">
    <li><a href="antenna-cli/index.html" title="Command Line Interface"><span class="none"></span>Command Line Interface</a>  </li>
    <li><a href="antenna-gradle-plugin/index.html" title="Gradle Plugin"><span class="none"></span>Gradle Plugin</a>  </li>
    <li><a href="antenna-maven-plugin/index.html" title="Maven"><span class="none"></span>Maven</a>  </li>
      </ul>
  </li>
    <li><a href="troubleshooting.html" title="Troubleshooting"><span class="none"></span>Troubleshooting</a>  </li>
    <li><a href="compliance-tool/index.html" title="Compliance Tool"><span class="none"></span>Compliance Tool</a>  </li>
          <li class="nav-header">Development</li>
    <li><a href="how-to-configure.html" title="How to configure Antenna"><span class="icon-chevron-down"></span>How to configure Antenna</a>
      <ul class="nav nav-list">
    <li><a href="tool-configuration.html" title="Tool Configuration"><span class="none"></span>Tool Configuration</a>  </li>
    <li><a href="config-configuration.html" title="config.xml"><span class="none"></span>config.xml</a>  </li>
    <li class="active"><a href="#"><span class="icon-chevron-down"></span>Workflow Configuration</a>

      <ul class="nav nav-list">
    <li><a href="analyzers/analyzers.html" title="Analyzers"><span class="none"></span>Analyzers</a>  </li>
    <li><a href="processors/processors.html" title="Processors"><span class="none"></span>Processors</a>  </li>
    <li><a href="generators/generators.html" title="Generators"><span class="none"></span>Generators</a>  </li>
    <li><a href="outputHandlers/outputHandlers.html" title="Output Handlers"><span class="none"></span>Output Handlers</a>  </li>
      </ul>
  </li>
      </ul>
  </li>
    <li><a href="dev-guide.html" title="Development Guide"><span class="none"></span>Development Guide</a>  </li>
    <li><a href="http-support/index_http.html" title="HTTP Support Library"><span class="none"></span>HTTP Support Library</a>  </li>
  </ul>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>Workflow configuration</h1>
<p>The steps Antenna executes are configured in a workflow configuration that comprises of:</p>
<ul>

<li>used analyzers</li>
<li>optional processors</li>
<li>used generators</li>
<li>optional output handlers.</li>
</ul>
<p>The configuration is located either in a separate workflow.xml file or directly in the tool configuration (e.g. pom.xml). Both ways use the same syntax, with one minor difference: In case the tool configuration is used you have specify the configuration entries with</p>

<div>
<div>
<pre class="source">&lt;project&gt;
    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.eclipse.sw360.antenna&lt;/groupId&gt;
                &lt;artifactId&gt;antenna-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;${org.eclipse.sw360.antenna.version}&lt;/version&gt;
                &lt;configuration&gt;
                    ...
                    &lt;workflow&gt;
                        &lt;processors&gt;
                            &lt;step&gt;
                                &lt;name&gt;Source Validator&lt;/name&gt;
                                &lt;classHint&gt;org.eclipse.sw360.antenna.validators.workflow.processors.SourceValidator&lt;/classHint&gt;
                                &lt;configuration&gt;
                                    &lt;entry&gt;
                                        &lt;entryKey&gt;missingSourcesSeverity&lt;/entryKey&gt;
                                        &lt;entryValue&gt;FAIL&lt;/entryValue&gt;
                                    &lt;/entry&gt;
                                    &lt;entry&gt;
                                        &lt;entryKey&gt;incompleteSourcesSeverity&lt;/entryKey&gt;
                                        &lt;entryValue&gt;WARN&lt;/entryValue&gt;
                                    &lt;/entry&gt;
                                &lt;/configuration&gt;
                                &lt;deactivated&gt;true&lt;/deactivated&gt;
                            &lt;/step&gt;
                        &lt;/processors&gt;
                    &lt;/workflow&gt;
                &lt;/configuration&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;analyze&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;
</pre></div></div>

<p>The file can contain variables that are replaced with values that are configured in the tool configuration (e.g. pom.xml).</p>
<p>Each workflow element is defined with a name and a class hint so Antenna can load it from the CLASSPATH. Additional configuration parameters can be passed to the single workflow steps via a configuration subsection.</p>
<p>The following example shows a workflow with one analyzer, one additional processor and two generators.</p>

<div>
<div>
<pre class="source">&lt;!-- Controlling the Antenna workflow --&gt;
&lt;workflow&gt;
    &lt;analyzers&gt;
        &lt;step&gt;
            &lt;name&gt;Example Analyzer&lt;/name&gt;
            &lt;classHint&gt;full.qualified.class.name&lt;/classHint&gt;
            &lt;configuration&gt;
                &lt;entry key=&quot;configuration_key_1&quot; value=&quot;configuration_value_1&quot; /&gt;
                &lt;entry key=&quot;configuration_key_2&quot; value=&quot;configuration_value_2&quot; /&gt;
            &lt;/configuration&gt;
        &lt;/step&gt;
    &lt;/analyzers&gt;
    &lt;processors&gt;
        &lt;step&gt;
            &lt;name&gt;Arbitrary processor&lt;/name&gt;
            &lt;classHint&gt;full.qualified.processor.class.name&lt;/classHint&gt;
            &lt;configuration&gt;
                &lt;entry key=&quot;configuration_key_2&quot; value=&quot;configuration_value_2&quot; /&gt;
            &lt;/configuration&gt;
        &lt;/step&gt;
    &lt;/processors&gt;
    &lt;generators&gt;
        &lt;step&gt;
            &lt;name&gt;First Generator&lt;/name&gt;
            &lt;classHint&gt;full.qualified.generator1.class.name&lt;/classHint&gt;
            &lt;configuration&gt;
                &lt;entry key=&quot;configuration_key_1&quot; value=&quot;configuration_value_1&quot; /&gt;
            &lt;/configuration&gt;
        &lt;/step&gt;
        &lt;step&gt;
            &lt;name&gt;Second Generator&lt;/name&gt;
            &lt;classHint&gt;full.qualified.generator2.class.name&lt;/classHint&gt;
        &lt;/step&gt;
    &lt;/generators&gt;
&lt;/workflow&gt;
</pre></div></div>

<div class="section">
<h2><a name="Workflow_order"></a>Workflow order</h2>
<p>The order of workflow steps does not correspond to the order of definition in the workflow. Instead, each workflow step has a number assigned (<tt>workflowStepOrder</tt>), which determines their execution: Lower numbers will get executed first.</p>
<p>The <tt>workflowStepOrder</tt> is a java short value. By default, a configurable workflow step will have a <tt>workflowStepOrder</tt> of 1000. A validator inheriting from <tt>abstract-antenna-compliance-checker</tt> will have a default <tt>workflowStepOrder</tt> of 10000 to ensure that validators run after enrichers.</p>
<p>Warnings will be issued if two workflow steps have the same priority. In that case, the workflow steps will be executed in the order they were introduced in the workflow. The evaluated order, together with the used values for <tt>workflowStepOrder</tt>, is logged on INFO log level.</p>
<p>One is able to override the order value corresponding to a workflow step using the <tt>workflowStepOrder</tt> tag. This could look something like</p>

<div>
<div>
<pre class="source">&lt;workflow&gt;
    &lt;processors&gt;
        &lt;step&gt;
            &lt;name&gt;Arbitrary processor&lt;/name&gt;
            &lt;classHint&gt;full.qualified.processor.class.name&lt;/classHint&gt;
            &lt;configuration&gt;
                &lt;entry key=&quot;configuration_key_2&quot; value=&quot;configuration_value_2&quot; /&gt;
            &lt;/configuration&gt;
            &lt;workflowStepOrder&gt;150&lt;/workflowStepOrder&gt;
        &lt;/step&gt;
    &lt;/processors&gt;
&lt;/workflow&gt;
</pre></div></div>

<p>This would move the <tt>Arbitrary processor</tt> to the front, but not before e.g. the <tt>AntennaConfHandler</tt> with order number <tt>0</tt>.</p></div>
<div class="section">
<h2><a name="Configuring_default_workflow_steps"></a>Configuring default workflow steps</h2>
<p>Antenna core is prepackaged with 3 analyzers and 5 generators:</p>
<ul>

<li><a href="./analyzers/json-analyzer-step.html">JSON Analyzer</a></li>
<li><a href="./analyzers/csv-analyzer-step.html">CSV analyzer</a></li>
<li><a href="./analyzers/mvn-dep-tree-analyzer-step.html">Maven Dependency Tree analyzer</a></li>
<li><a href="./generators/HTML-report-generator-step.html">HTML generator</a></li>
<li><a href="./generators/csv-generator-step.html">CSV generator</a></li>
<li><a href="./generators/source-zip-generator-step.html">Source Zip Generator</a></li>
<li><a href="./generators/sw360-update-generator-step.html">SW360 update generator</a></li>
</ul>
<p>However, it is quite likely that the default configuration that is provided at your organization already contains a lot more workflow steps.</p>
<p>A complete example on how to configure the plugin can be found in the file</p>

<div>
<div>
<pre class="source">example-projects/example-project/src/workflow.xml
</pre></div></div>

<p>Since the Antenna tool is though to be used to enforce a company-wide standard approach to maintain open source license compliance, it allows for providing a standard workflow definition that is loaded from the classpath.</p>
<p><b>Antenna loads  a default workflow</b> from the CLASSPATH at <tt>/workflow.xml</tt>.</p>
<p>The default workflow looks like this.</p>

<div>
<div>
<pre class="source">assembly/configuration/src/main/resources/workflow.xml
</pre></div></div>

<p>The default workflow contains the general steps that should be performed for a project with respect to open source compliance management but leaves out configuration that is specific for your project. For that you need to adjust the workflow for your project. E.g. it might be that some workflow steps require credentials for external systems, you want to specify custom file paths or you want to add other steps to the workflow. This has to be performed in your custom workflow configuration.</p>
<p>You can include another <tt>workflow.xml</tt> which you can configure via <tt>workflowDefinitionFile</tt> in the <tt>pom.xml</tt> file.</p>

<div>
<div>
<pre class="source">    &lt;workflowDefinitionFile&gt;${basedir}/customWorkflow.xml&lt;/workflowDefinitionFile&gt;
</pre></div></div>

<p>If you, for example, want to add a CSV Analyzer the <tt>customWorkflow.xml</tt> file will look like this:</p>

<div>
<div>
<pre class="source">&lt;workflow&gt;
    &lt;analyzers&gt;
        &lt;step&gt;
            &lt;name&gt;CSV Analyzer&lt;/name&gt;
            &lt;classHint&gt;org.eclipse.sw360.antenna.workflow.sources.analyzer.CsvAnalyzer&lt;/classHint&gt;
            &lt;configuration&gt;
                &lt;entry key=&quot;file.path&quot; value=&quot;${basedir}/reportdata.csv&quot; /&gt;
                &lt;entry key=&quot;base.dir&quot; value=&quot;/home/jenkins/agent/workspace/antenna-documentation-site-deploy/antenna-documentation/target/sources&quot;/&gt;
            &lt;/configuration&gt;
        &lt;/step&gt;
    &lt;/analyzers&gt;
&lt;/workflow&gt;
</pre></div></div>

<p>The effective workflow will then consist of the entries of the default workflow and the entries you specified in your workflow.</p>
<p>If you want to add custom workflow steps you need to have the implementation of the workflow step on the classpath. For that you can use standard maven means. By configuring an additional dependency for the Antenna maven plugin you can provide any further workflow steps that are available as maven dependency.</p></div>
<div class="section">
<h2><a name="Using_the_same_workflow_step_twice"></a>Using the same workflow step twice</h2>
<p>It is possible to run the same workflow step, with a different configuration, twice, or more, within one Antenna run. In order to use the same workflow step twice, you simply have to add it another time to the workflow.</p>

<div>
<div>
<pre class="source">&lt;workflow&gt;
    &lt;analyzers&gt;
        &lt;step&gt;
            &lt;name&gt;CSV Analyzer&lt;/name&gt;
            &lt;classHint&gt;org.eclipse.sw360.antenna.workflow.sources.analyzer.CsvAnalyzer&lt;/classHint&gt;
            &lt;configuration&gt;
                &lt;entry key=&quot;file.path&quot; value=&quot;${basedir}/reportdata.csv&quot; /&gt;
                &lt;entry key=&quot;base.dir&quot; value=&quot;/home/jenkins/agent/workspace/antenna-documentation-site-deploy/antenna-documentation/target/sources&quot;/&gt;
            &lt;/configuration&gt;
        &lt;/step&gt;
        &lt;step&gt;
            &lt;name&gt;CSV Analyzer 2&lt;/name&gt;
            &lt;classHint&gt;org.eclipse.sw360.antenna.workflow.sources.analyzer.CsvAnalyzer&lt;/classHint&gt;
            &lt;configuration&gt;
                &lt;entry key=&quot;file.path&quot; value=&quot;${basedir}/otherFile.csv&quot; /&gt;
                &lt;entry key=&quot;base.dir&quot; value=&quot;/home/jenkins/agent/workspace/antenna-documentation-site-deploy/antenna-documentation/target/otherFolder&quot;/&gt;
            &lt;/configuration&gt;
        &lt;/step&gt;
    &lt;/analyzers&gt;
&lt;/workflow&gt;
</pre></div></div>

<p>Here you need to be careful to change the <tt>&lt;name&gt;</tt> value of the workflow step, as demonstrated below with a second <tt>Source Validator</tt>. Should the two workflow steps not differ in the name, the configuration of the first workflow step would simply be overwritten with those of the second and the workflow step would only be executed once.</p>
<p>Additionally, you need to add the default workflow configuration values, should you use a workflow step twice that has default configuration values provided by the default workflow. This is necessary since the default workflow configuration values are provided in the run by merging the workflow step configurations that have the same name. This is the reason why the repeated workflow steps need to differ in name and why the default configuration values are not also applied to the doubled and renamed workflow step.</p>
<p>Note: It is important, that the classHints do not differ. We use them to identify the actual workflow step.</p></div>
<div class="section">
<h2><a name="Configuring_the_workflow_in_the_pom.xml"></a>Configuring the workflow in the pom.xml</h2>
<p>It is also possible to configure additional steps to a <tt>workflow.xml</tt> directly in the tool configuration. For further information, see the <a href="./tool-configuration.html">Tool configuration</a>.</p></div>
<div class="section">
<h2><a name="Usage_of_POM_properties_in_the_workflow.xml"></a>Usage of POM properties in the workflow.xml</h2>
<p>For technical reasons properties will in general not be rendered correctly in the workflow.xml. This means that</p>
<ul>

<li>

<p>No properties declared in the Maven POM can be used, since they will not be rendered correctly. Instead of rendering <tt>${system.password}</tt> to <tt>password1234</tt> as declared in the pom.xml, the literal <tt>&quot;${system.password}&quot;</tt> will be used. If those properties are used, they will most likely cause build, authentication or access issues or errors.</p>
</li>
<li>

<p>For a Maven frontend, every Maven <tt>project</tt> property can be used.</p>
</li>
<li>

<p>For a Gradle or CLI frontend, the following additional properties are available and preset:</p>
<ul>

<li><tt>basedir</tt>: build folder (i.e. <tt>build</tt> for Gradle or <tt>target</tt> for CLI)</li>
<li><tt>project.basedir</tt> and <tt>project.baseUri</tt>: path and uri to current <tt>pom.xml</tt> file.</li>
<li><tt>project.build.directory</tt>: build folder (i.e. <tt>build</tt> for Gradle or <tt>target</tt> for CLI)</li>
<li><tt>project.build.outputDirectory</tt>: build output folder relative to pom file (e.g. <tt>target/classes</tt>)</li>
<li><tt>project.build.sourceDirectory</tt>: source directory assuming a maven structure relative to pom file (<tt>src/main/java</tt>)</li>
<li><tt>project.build.testSourceDirectory</tt>: test source directory assuming a maven structure relative to pom file (<tt>src/test/java</tt>)</li>
</ul>
</li>
</ul></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2020.
All rights reserved.</p>
        </div>
        </div>
    </footer>
    </body>
</html>
